weba:
  build: docker/web
  links:
   - db:db
  expose:
    - 80

webb:
  build: docker/web
  links:
   - db
  expose:
    - 80

webc:
  build: docker/web
  links:
   - db
  expose:
    - 80

db:
   build: docker/db
   environment: 
      MYSQL_ROOT_PASSWORD: secret
      MYSQL_DB: webusers
      MYSQL_USER: dbadmin
      MYSQL_PASS: dbpassword
      MYSQL_ALLOW_EMPTY_PASSWORD: "yes"
   ports:
      - 3306:3306

haproxy:
  build: docker/haproxy
  volumes:
   - haproxy:/haproxy-override
  links:
   - weba
   - webb
   - webc

  ports:
   - "80:80"
   - "70:70"
  expose:
   - "80"
   - "70"